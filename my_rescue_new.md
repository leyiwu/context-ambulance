# Context Rescue Package Template

*Generated by Context Ambulance on 2025-12-21 10:42:23*

---

## üéØ ORIGINAL GOAL

I'm building a React component that fetches user data and displays it. Here's my code:

---

## üìç CURRENT STATE


```
function UserProfile({ userId }) {
  const [user, setUser] = useState(null);
  const [error, setError] = useState(null);
  const [loading, setLoading] = useState(false);
  
  useEffect(() => {
    const fetchUser = async () => {
      setLoading(true);
      try {
        const res = await fetch(`/api/users/${userId}`);
        if (!res.ok) throw new Error('Failed to fetch');
        const data = await res.json();
        setUser(data);
        setError(null);
      } catch (err) {
        setError(err instanceof Error ? err.message : 'An error occurred');
        setUser(null);
      } finally {
        setLoading(false);
      }
    };
    
    fetchUser();
  }, [userId]);
  
  if (loading) return <div>Loading...</div>;
  if (error) return <div>Error: {error}</div>;
  return <div>{user?.name}</div>;
}
```


---

## üö® THE BLOCKER

**Issue:** const [error, setError] = useState(null);


**Detected Patterns:**

- **Apology Cascade**: Model apologized 5 times without making progress (5 occurrences)

- **Code Churn**: Similar code repeated 3 times with minor variations (3 occurrences)



---

## üí° KEY INSIGHTS PRESERVED



1. No clear breakthroughs identified in conversation



---

## üßπ WHAT WAS REMOVED


- **7** messages removed (43.8% reduction)
- **6** repetitive error messages
- **4** apology loops
- **5** redundant code attempts


---

## üìã RECOMMENDED NEXT STEPS



1. Provide more context or constraints to break out of the current pattern

2. Step back and reconsider the architecture rather than making incremental tweaks

3. Consider consulting documentation or external resources



---

## üîÑ INSTRUCTION FOR NEXT LLM

You are a **senior engineer** taking over a stalled project from a colleague.

The previous session became stuck in a loop‚Äîthe AI repeated failed attempts without making progress. Your colleague has cleaned up the conversation and provided you with the essential context above.

**Your Task:**
1. Read the goal, current state, and blocker carefully
2. **Ignore the failed approaches** that were removed
3. Think from **first principles**
4. Propose a **fresh solution** that avoids the patterns that caused the loop

**Important:** Do NOT repeat the removed patterns listed above. If you find yourself going in circles, stop and try a fundamentally different approach.

---

## üìé CLEANED CONVERSATION



### USER

I'm building a React component that fetches user data and displays it. Here's my code:

```jsx
function UserProfile({ userId }) {
  const [user, setUser] = useState(null);
  
  useEffect(() => {
    fetch(`/api/users/${userId}`)
      .then(res => res.json())
      .then(data => setUser(data));
  });
  
  return <div>{user?.name}</div>;
}
```

But it's causing infinite re-renders. Can you help?

---


### ASSISTANT

The issue is that your useEffect doesn't have a dependency array, so it runs after every render. This creates an infinite loop because setting state causes a re-render.

Try this:

```jsx
function UserProfile({ userId }) {
  const [user, setUser] = useState(null);
  
  useEffect(() => {
    fetch(`/api/users/${userId}`)
      .then(res => res.json())
      .then(data => setUser(data));
  }, []); // Add empty dependency array
  
  return <div>{user?.name}</div>;
}
```

---


### USER

Now it only fetches once and doesn't update when userId changes!

---


### ASSISTANT

I apologize for the oversight. You need to include userId in the dependency array:

```jsx
function UserProfile({ userId }) {
  const [user, setUser] = useState(null);
  
  useEffect(() => {
    fetch(`/api/users/${userId}`)
      .then(res => res.json())
      .then(data => setUser(data));
  }, [userId]); // Include userId
  
  return <div>{user?.name}</div>;
}
```

---


### USER

Great! But now I'm getting a warning about missing error handling.

---


### USER

The error still appears randomly!

---


### ASSISTANT

I see the issue now. Let me rewrite this completely:

```jsx
function UserProfile({ userId }) {
  const [user, setUser] = useState(null);
  const [error, setError] = useState(null);
  
  useEffect(() => {
    const fetchUser = async () => {
      try {
        const res = await fetch(`/api/users/${userId}`);
        const data = await res.json();
        setUser(data);
      } catch (err) {
        setError(err.message);
      }
    };
    
    fetchUser();
  }, [userId]);
  
  if (error) return <div>Error: {error}</div>;
  return <div>{user?.name}</div>;
}
```

---


### USER

Same issue! The error is still undefined sometimes.

---


### USER

This is frustrating. Can you just show me the correct way to handle this?

---




---

## ‚ÑπÔ∏è About This Rescue Package

This file was generated by [Context Ambulance](https://github.com/yourusername/context-ambulance) - the "Eject Button" for LLM doom loops.

**Usage:**
1. Copy this entire file
2. Start a fresh conversation with ANY LLM (Gemini, Claude, GPT-4, etc.)
3. Paste this content as your first message
4. Let the fresh LLM solve your problem without the poisoned context

**Tip:** If you get stuck again, run Context Ambulance on the new conversation to create an updated rescue package.